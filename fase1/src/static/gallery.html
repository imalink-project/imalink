<!DOCTYPE html>
<html lang="no">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bildegalleri - ImaLink</title>
    <link rel="stylesheet" href="/static/styles.css">
</head>
<body>
    <!-- Mobile Navigation Toggle -->
    <button class="mobile-nav-toggle" onclick="toggleSidebar()">â˜°</button>

    <!-- Sidebar Navigation -->
    <nav class="sidebar" id="sidebar">
        <div class="logo">
            <h2>ğŸ“¸ ImaLink</h2>
            <p>BildehÃ¥ndtering</p>
        </div>

        <ul class="nav-menu">
            <li class="nav-item">
                <a href="/" class="nav-link">
                    <span class="nav-icon">ğŸ </span>
                    Dashboard
                </a>
            </li>
            <li class="nav-item">
                <a href="/gallery" class="nav-link active">
                    <span class="nav-icon">ğŸ–¼ï¸</span>
                    Bildegalleri
                </a>
            </li>
            <li class="nav-item">
                <a href="/selections" class="nav-link">
                    <span class="nav-icon">ğŸ“</span>
                    Selections
                </a>
            </li>
            <li class="nav-item">
                <a href="/import" class="nav-link">
                    <span class="nav-icon">ğŸ“¥</span>
                    Import
                </a>
            </li>
            <li class="nav-item">
                <a href="/authors" class="nav-link">
                    <span class="nav-icon">ğŸ‘¥</span>
                    Fotografer
                </a>
            </li>

        </ul>
    </nav>

    <!-- Main Content -->
    <main class="main-content">
        <div class="container">
            <!-- Search Section -->
            <div class="section">
                <h2>ğŸ” SÃ¸k i bilder</h2>
                <div class="search-form">
                    <input type="text" id="searchQuery" class="form-input" placeholder="SÃ¸k i filnavn..." />
                    <input type="date" id="searchDateFrom" class="form-input" />
                    <input type="date" id="searchDateTo" class="form-input" />
                    <button onclick="searchImages()" class="btn btn-primary">SÃ¸k</button>
                    <button onclick="loadAllImages()" class="btn btn-secondary">Vis alle</button>
                </div>
            </div>

            <!-- Gallery Section -->
            <div class="section">
                <h2>ğŸ–¼ï¸ Bildegalleri</h2>
                <div id="imageCount" class="image-count"></div>
                
                <!-- Test Modal Button (temporary) -->
                <button onclick="testModal()" class="btn btn-primary" style="margin-bottom: 1rem;">
                    ğŸ§ª Test Modal (midlertidig)
                </button>
                
                <div id="gallery" class="gallery-grid">
                    <!-- Images will be loaded here -->
                </div>
                <div id="loadingIndicator" class="loading hidden">
                    Laster bilder...
                </div>
            </div>
        </div>
    </main>

    <!-- Enhanced Image Viewer Modal -->
    <div id="imageModal" class="modal hidden">
        <div class="modal-content image-viewer">
            <div class="viewer-header">
                <h3 id="viewerTitle">Bildevisning</h3>
                <button class="close" onclick="closeModal()" title="Lukk">&times;</button>
            </div>
            
            <div class="viewer-controls">
                <div class="size-controls">
                    <label for="sizeSelector">StÃ¸rrelse:</label>
                    <select id="poolSizeSelector" class="form-select" onchange="onPoolSizeChange()">
                        <option value="small">Liten (400px)</option>
                        <option value="medium" selected>Medium (800px)</option>
                        <option value="large">Stor (1200px)</option>
                    </select>
                </div>
                
                <div class="action-controls">
                    <button id="viewerRotateBtn" class="btn btn-primary" onclick="rotateViewerImage()" title="Roter 90Â°">
                        ğŸ”„ Roter
                    </button>
                    <button id="viewerDownloadBtn" class="btn btn-secondary" onclick="downloadViewerImage()" title="Last ned pool-bilde">
                        ğŸ’¾ Last ned
                    </button>
                </div>
            </div>
            
            <div class="viewer-body">
                <div class="image-container" id="viewerImageContainer">
                    <div id="imageLoadingSpinner" class="loading hidden">Laster bilde...</div>
                    <div id="imageError" class="error-message hidden">
                        Kunne ikke laste bilde. PrÃ¸v en annen stÃ¸rrelse.
                    </div>
                </div>
                
                <div class="image-info-panel">
                    <h4>ğŸ“‹ Filinformasjon</h4>
                    <div id="imageFileInfo" class="image-details">
                        <!-- Details will be populated here -->
                    </div>
                    
                    <h4>ğŸ“Š Tekniske detaljer</h4>
                    <div id="imageTechnicalInfo" class="image-technical">
                        <!-- Technical details will be populated here -->
                    </div>
                    
                    <h4>ğŸ“ Metadata</h4>
                    <div id="imageMetadataInfo" class="image-metadata">
                        <!-- Metadata will be populated here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="/static/gallery.js"></script>
    <script>
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            sidebar.classList.toggle('open');
        }

        // Close sidebar when clicking outside on mobile
        document.addEventListener('click', function(event) {
            const sidebar = document.getElementById('sidebar');
            const toggle = document.querySelector('.mobile-nav-toggle');
            
            if (window.innerWidth <= 768 && 
                !sidebar.contains(event.target) && 
                !toggle.contains(event.target)) {
                sidebar.classList.remove('open');
            }
        });
    </script>
</body>
</html>